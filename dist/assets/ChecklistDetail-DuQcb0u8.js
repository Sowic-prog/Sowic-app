import{m as g,u as j,r as i,s as x,j as e,b as N,g as v,i as y}from"./index-DOan4Mna.js";import{C as w}from"./chevron-left-dnm8qLMD.js";import{U as k}from"./user-B0nrHmCb.js";import{S as C}from"./sparkles-7t21aLkv.js";import{T as F}from"./triangle-alert-Cdjg_spt.js";import{C as z}from"./circle-alert-eSyUdlLx.js";const $=()=>{const{id:c}=g(),m=j(),[r,p]=i.useState(null),[h,n]=i.useState(!0);i.useEffect(()=>{c&&f(c)},[c]);const f=async t=>{try{n(!0);let{data:a,error:s}=await x.from("checklists").select("*").eq("id",t).single();if(s||!a){const{data:u,error:o}=await x.from("checklists").select("*").eq("mock_id",t).single();if(o)throw o;a=u}a&&p({id:a.mock_id||a.id,assetId:a.asset_id,assetName:a.asset_name,date:a.date,inspector:a.inspector,conformity:a.conformity,items:a.items||[]})}catch(a){console.error("Error fetching checklist:",a),alert("Error al cargar el checklist.")}finally{n(!1)}},d=t=>t>=90?"text-green-500 bg-green-50 border-green-100":t>=70?"text-yellow-500 bg-yellow-50 border-yellow-100":"text-red-500 bg-red-50 border-red-100",b=t=>{switch(t){case"ok":return e.jsx(y,{size:18,className:"text-green-500"});case"fail":return e.jsx(z,{size:18,className:"text-red-500"});case"warning":return e.jsx(F,{size:18,className:"text-yellow-500"});default:return e.jsx("div",{className:"w-4 h-4 rounded-full bg-slate-200"})}};if(h)return e.jsx("div",{className:"min-h-screen bg-[#F8F9FA] flex items-center justify-center text-slate-400",children:"Cargando..."});if(!r)return e.jsx("div",{className:"min-h-screen bg-[#F8F9FA] flex items-center justify-center",children:"Checklist no encontrado"});const l={};return r.items.forEach(t=>{l[t.category]||(l[t.category]=[]),l[t.category].push(t)}),e.jsxs("div",{className:"bg-[#F8F9FA] min-h-screen pb-20 font-sans",children:[e.jsxs("div",{className:"bg-white p-4 sticky top-0 z-20 shadow-sm flex items-center justify-between",children:[e.jsx("button",{onClick:()=>m("/maintenance"),className:"text-slate-600","aria-label":"Volver",children:e.jsx(w,{size:24})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("h1",{className:"font-bold text-lg text-slate-800",children:["InspecciÃ³n #",r.id]}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium tracking-wide bg-slate-100 px-2 py-0.5 rounded-full mt-1",children:r.assetName})]}),e.jsx("div",{className:"w-8"})," "]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100 relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider",children:"Conformidad"}),e.jsxs("div",{className:`text-3xl font-black ${d(r.conformity).split(" ")[0]}`,children:[r.conformity,"%"]})]}),e.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase border ${d(r.conformity)}`,children:r.conformity>=90?"Aprobado":"Revisar"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-50 p-4 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[e.jsx(N,{size:14}),e.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Fecha"})]}),e.jsx("p",{className:"font-bold text-slate-700 text-sm",children:r.date})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[e.jsx(k,{size:14}),e.jsx("span",{className:"text-[10px] font-bold uppercase",children:"Inspector"})]}),e.jsx("p",{className:"font-bold text-slate-700 text-sm",children:r.inspector})]})]})]}),e.jsx("div",{className:"space-y-6",children:Object.entries(l).map(([t,a])=>e.jsxs("div",{className:"bg-white p-5 rounded-[2rem] shadow-sm border border-slate-100",children:[e.jsxs("h3",{className:"font-bold text-slate-700 text-sm border-b border-slate-100 pb-3 mb-4 flex items-center gap-2",children:[e.jsx(v,{size:16,className:"text-orange-500"}),t]}),e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"group",children:[e.jsx("div",{className:"flex items-start justify-between gap-3 mb-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded-full ${s.status==="ok"?"bg-green-100":"bg-red-100"}`,children:b(s.status)}),e.jsx("span",{className:`text-sm font-medium ${s.status==="ok"?"text-slate-600":"text-slate-800"}`,children:s.label})]})}),(s.comment||s.photoData||s.aiAnalysis)&&e.jsxs("div",{className:"ml-10 bg-slate-50 p-3 rounded-xl space-y-2 mt-2",children:[s.comment&&e.jsxs("p",{className:"text-xs text-slate-500 italic",children:['"',s.comment,'"']}),s.photoData&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:s.photoData,alt:"Evidencia",className:"h-20 w-20 object-cover rounded-lg border border-slate-200"})}),s.aiAnalysis&&e.jsxs("div",{className:"flex gap-2 items-start bg-purple-50 p-2 rounded-lg border border-purple-100",children:[e.jsx(C,{size:12,className:"text-purple-500 mt-0.5 shrink-0"}),e.jsx("p",{className:"text-[10px] text-purple-700 leading-tight",children:s.aiAnalysis})]})]}),e.jsx("div",{className:"border-b border-slate-50 mt-3 group-last:border-0"})]},s.id))})]},t))})]})]})};export{$ as default};
